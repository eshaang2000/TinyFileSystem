1. Regarding seperating dirname and basename - 
you can use the inbuilt functions dirname() and basename(). Please lookup up https://linux.die.net/man/3/dirname
if confused